---
title: "Supplement A"
author: "Elizabeth McNeilly"
date: "10/29/2021"
output: html_document
---
#NOTE:  The purpose of this script is to provide the results for Sample 1.

# SETUP
```{r loadPackages, echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


library(ggplot2)
library(gamm4)
library(dplyr)
library(sjPlot)
library(here)


# Elizabeth.
# Data: Desktop⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# Code: Desktop⁩ ▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code⁩

# Lucia.
# Data:  Github⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# Code:  Github ▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code

# Natalie.
# Data:  Desktop ▸ ABCD⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# Code:  Desktop ▸ ABCD ⁩▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code

# LMW alternative to read in the data.

data_dir = ((dirname(here()))) 

phase_folder = "exploratory"  # select the appropriate folder.
#phase_folder = "confirmatory"  # select the appropriate folder.

data_folder <- file.path(data_dir,"ABCD","derivatives",phase_folder)

file_name <- "nda30_exploratory.csv" # specify file name here. 

fulldata <- read.csv(file.path(data_folder,file_name))
nrow(fulldata) # 27321 (exploratory). When call the define_dataframes script, will keep only the baseline data.

# Call function to define all of the dataframes.
script_path <- file.path(data_dir,"rewardprocesses_internalizing_puberty_exploratory","code","define_dataframes.R")
source(script_path)
```

# RQ1
# Confirmatory Hypothesis 1: We hypothesize that pubertal stage will be associated with neural response to reward during a monetary incentive delay task (Braams et al., 2015). In particular, we expect heightened striatal activation during reward anticipation for more advanced pubertal stages.
## Model: Striatal activation (anticipation stage) ~ Pubertal stage

#### Females.
```{r Confirmatory1Female_Striatum, echo = FALSE}
dataformodel <- data_no_striatal_ant_outliers_females

# Note: only include race and ethnicity as covariates when PDS is a predictor *and* CBCL is the outcome in the model.
confirmatory1_females <- gamm4(striatum_rvsn_ant_z ~ PDS_score + interview_age,
                               #race.ethnicity.5level +
                               #demo_race_hispanic,
                               #high.educ +
                               #household.income +
                               #married.or.livingtogether
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_females$gam)

```

#### Males.
```{r Confirmatory1Male_Striatum, echo = FALSE}
dataformodel <- data_no_striatal_ant_outliers_males

confirmatory1_males<- gamm4(striatum_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)
summary(confirmatory1_males$gam)
library(stargazer)
stargazer(confirmatory1_males$mer)

```

# Exploratory Hypothesis 1A: We will explore whether striatal activation during reward feedback is related to pubertal stage.
## Model: Striatal activation (feedback stage) ~ Pubertal stage
### Females.
```{r Exploratory1AFemales, echo = FALSE}
dataformodel <- data_no_striatal_feed_outliers_females

exploratory1A_females <- gamm4(striatum_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_females$gam)

```

### Males.
```{r Exploratory1AMales, echo = FALSE}
dataformodel <- data_no_striatal_feed_outliers_males

exploratory1A_males <- gamm4(striatum_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_males$gam)

```
# Exploratory Hypothesis 1B: We hypothesize that more advanced pubertal stages will be associated with greater self-reported reward responsiveness (BAS - RR) (Harden et al. 2018).
## Model: BIS-BAS-RR ~ Pubertal stage
### Females.
```{r Exploratory1BFemales, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory1B_females <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_females$gam)

```
### Males.
```{r Exploratory1BMales, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory1B_males <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_males$gam)

```
# Exploratory Hypothesis 1C: We hypothesize that greater pubertal stage will be associated with greater behavioral reactivity to reward (i.e., reaction time on reward vs. neutral trials).
## Model: Reaction Time ~ Pubertal Stage

### Females.
```{r Exploratory1CFemales, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_females

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_females$gam)


# Large reward vs. small positive.
exploratory1C_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_females$gam)
```

### Males.
```{r Exploratory1CMales, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_males

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_males$gam)


# Large reward vs. small positive.
exploratory1C_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_males$gam)
```
# Exploratory Hypothesis 1D: We hypothesize that testosterone will be positively associated with our indicators of reward (neural activity, behavioral reaction time, and self-reported reward responsiveness).
## Model A: Striatal activation (anticipation stage) ~ Testosterone
### Females.
```{r Exploratory1D_A, echo = FALSE}
## Model A: Striatal activation (anticipation stage) ~ Testosterone
# Females.
dataformodel <- data_no_striatal_ant_test_outliers_females # No striatal anticipation or testosterone outliers.
modelA_females <- gamm4(striatum_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelA_females$gam)
```

### Males.
```{r}
# Males.
dataformodel <- data_no_striatal_ant_test_outliers_males # No striatal anticipation or testosterone outliers.
modelA_males <- gamm4(striatum_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelA_males$gam)
```

## Model B: Striatal activation (feedback stage) ~ Testosterone
### Females.
```{r Exploratory1D_B, echo = FALSE}
## Model B: Striatal activation (feedback stage) ~ Testosterone
# Females.
dataformodel <- data_no_striatal_feed_test_outliers_females # No striatal feedback or testosterone outliers.
modelB_females <- gamm4(striatum_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelB_females$gam)
```

### Males.
```{r}
# Males.
dataformodel <- data_no_striatal_feed_test_outliers_males # No striatal feedback or testosterone outliers.
modelB_males <- gamm4(striatum_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelB_males$gam)
```

## Model C: OFC activation (anticipation stage) ~ Testosterone
### Females.
```{r Exploratory1D_C, echo = FALSE}
## Model C: OFC activation (anticipation stage) ~ Testosterone

# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_females
modelC_females_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_females
modelC_females_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_mOFC$gam)

```

### Males.
```{r}
# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_males
modelC_males_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_males
modelC_males_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_mOFC$gam)
```

## Model D: OFC activation (feedback stage) ~ Testosterone
### Females.
```{r Exploratory1D_D, echo = FALSE}
## Model D: OFC activation (feedback stage) ~ Testosterone

# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_females
modelD_females_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_females
modelD_females_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_mOFC$gam)
```

### Males.
```{r}

# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_males
modelD_males_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_males
modelD_males_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_mOFC$gam)
```

## Model E: MID Reaction Time ~ Testosterone
### Females.
```{r Exploratory1D, echo = FALSE}
## Model E: MID Reaction Time ~ Testosterone
# Females: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_females$gam)

# Females: large reward vs. small reward.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_females$gam)
```

### Males.
```{r}
# Males: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_males # No MID RT difference score or testosterone outliers.

modelE_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_males$gam)

# Males: large reward vs. small reward.
modelE_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_males$gam)
```

## Model F: BIS-BAS-RR ~ Testosterone
### Females.
```{r Exploratory1D_F, echo = FALSE}
## Model F: BIS-BAS-RR ~ Testosterone
#Females
dataformodel <- data_no_bisbas_test_outliers_females
modelF_females <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_females$gam)
```
### Males.
```{r}
dataformodel <- data_no_bisbas_test_outliers_males
modelF_males <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_males$gam)
```

# Confirmatory Hypothesis 1 SEPARATE STRIATAL REGIONS (anticipation stage) 
## Model A: Caudate Anticipation ~ Pubertal stage
### Females.
```{r Confirmatory1Female_Caudate, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females 

confirmatory1_caudate_females <- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_females$gam)

```

### Males.
```{r Confirmatory1Male, echo = FALSE}
dataformodel <- data_no_striatal_ant_outliers_males

confirmatory1_caudate_males<- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_males$gam)

```

## Model B: Putamen Anticipation ~ Pubertal stage
### Females.
```{r Confirmatory1Female_Putamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females 

confirmatory1_putamen_females <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_females$gam)

```

### Males.
```{r Confirmatory1Male_Putamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males 

confirmatory1_putamen_males <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_males$gam)
```

## Model C: Accumbens Anticipation ~ Pubertal stage
### Females.
```{r Confirmatory1Female_Accumbens, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_females 

confirmatory1_accumbens_females <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_females$gam)

```

### Males.
```{r Confirmatory1Male_Accumbens, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males 

confirmatory1_accumbens_males <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_males$gam)

```

# Exploratory Hypothesis 1A: SEPARATE STRIATAL REGIONS (feedback stage)
## Model A: Caudate Feedback  ~ Pubertal stage
### Females.
```{r Exploratory1A_Caudate_Females, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

exploratory1A_caudate_females <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_females$gam)

```

### Males.
```{r Exploratory1A_Caudate_Males, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

exploratory1A_caudate_males <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_males$gam)

```
## Model B: Putamen Feedback ~ Pubertal stage
### Females.
```{r Exploratory1A_Putamen_Females, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

exploratory1A_putamen_females <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_females$gam)

```

### Males.
```{r Exploratory1A_Putamen_males, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

exploratory1A_putamen_males <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_males$gam)

```
## Model C: Accumbens Feedback ~ Pubertal stage
### Females.
```{r Exploratory1A_Accumbens_Females, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

exploratory1A_accumbens_females <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_females$gam)

```

### Males.
```{r Exploratory1A_Accumbens_Males, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

exploratory1A_accumbens_males <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_males$gam)

```


# RQ2
# Confirmatory Hypothesis 2: We hypothesize that advanced pubertal stage will be associated with higher internalizing symptoms as measured by the Child Behavior Checklist (CBCL) internalizing factor (Ullsperger & Nikolas, 2017).


## Model A: CBCL internalizing factor ~ Pubertal stage
### Females.
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```

## Model B: CBCL Anxious-Depressed ~ Pubertal stage
### Females.
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)

coef_test(confirmatory2_females$mer, vcov = "CR2", coeffs = "all")
# beta =  0.42161; t= 2.56; p = 0.019.
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```
## Model C: CBCL Withdrawn-Depressed ~ Pubertal stage
### Females.
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
coef_test(confirmatory2_females$mer, vcov = "CR2", coeffs = "all")
# beta = 0.38; t= 4.53; p < 0.001.
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```
## Model D: CBCL Depressed DSM-5 ~ Pubertal stage
### Females.
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)

coef_test(confirmatory2_females$mer, vcov = "CR2", coeffs = "all")
# beta = 0.32; t= 3.32; p = 0.004.
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```

# Exploratory Hypothesis 2: We hypothesize that advanced pubertal stage (categorical) will be associated with higher internalizing symptoms as measured by the Child Behavior Checklist (CBCL)?


## Model A: CBCL internalizing factor ~ Pubertal category
### Females.
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## Model B: CBCL Anxious-Depressed ~ Pubertal category
### Females. 
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## Model C: CBCL Withdrawn-Depressed ~ Pubertal category
### Females.
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## Model D: CBCL Depressed DSM-5 ~ Pubertal category
### Females.
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males.
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```




# Exploratory Hypothesis 3: We will investigate whether testosterone relates to internalizing symptoms.

## Model A: CBCL internalizing factor ~ Testosterone
### Females.
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males.
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```
## Model B: CBCL Anxious-Depressed ~ Testosterone
### Females.
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males.
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```

## Model C: CBCL Withdrawn-Depressed ~ Testosterone
### Females.
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```

### Males.
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```
## Model D: CBCL Depressed DSM-5 ~ Testosterone
### Females.
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males.
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```

# Exploratory Hypothesis 4: We will investigate whether testosterone relates to internalizing symptoms after controlling for PDS.

## Model A: CBCL internalizing factor ~ Testosterone + Pubertal stage 
### Females.
```{r Exploratory2B, echo = FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)

# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males.
```{r}
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)

# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## Model B: CBCL Anxious-Depressed ~ Testosterone + Pubertal stage 
### Females.
```{r Exploratory2B, echo = FALSE}
#FEMALES
dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)

# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males.
```{r}
#MALES
dataformodel <- data_no_test_outliers_males 
  
confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)


# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## Model C: CBCL Withdrawn-Depressed ~ Testosterone + Pubertal stage 
### Females.
```{r Exploratory2B, echo = FALSE}
#FEMALES
dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)

# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males.
```{r}
#MALES
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)

# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## Model D: CBCL Depressed DSM-5 ~ Testosterone + Pubertal stage 
### Females.
```{r Exploratory2B, echo = FALSE}
#FEMALES
dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)

# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males.
```{r}
#MALES
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)

# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      #high.educ +
                      #household.income +
                      #married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic,
                      #fam_history_q6d_depression + #added mother's depression
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```



# RQ3
# Confirmatory Hypothesis 3: We hypothesize that striatal and orbitofrontal cortex activity during the reward anticipation and feedback stages of the MID task will be negatively associated with internalizing symptoms (Forbes et al., 2010; Ubl et al., 2015; Luking et al., 2016).

## Model A: CBCL internalizing factor ~ Striatal activity (anticipation stage - All reward v. neutral)
### Females.
```{r Confirmatory3AFemale, echo = FALSE}
#dataformodel <- data_no_CBCL_striatal_ant_outliers_females # Not excluding CBCL outliers.
dataformodel <- data_no_striatal_ant_outliers_females 

confirmatory3A_females <- gamm4(cbcl_scr_syn_internal_r ~ striatum_rvsn_ant_z +
                                interview_age +
                                race.ethnicity.5level +
                                #high.educ +
                                #household.income +
                                #married.or.livingtogether +
                                demo_race_hispanic, 
                                random = ~ (1 | site_id_l/rel_family_id),
                                data = dataformodel)

summary(confirmatory3A_females$gam)


```
### Males.
```{r Confirmatory3AMale, echo = FALSE}
dataformodel <- data_no_striatal_ant_outliers_males
confirmatory3A_males <- gamm4(cbcl_scr_syn_internal_r ~ striatum_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_males$gam)

```

## Model A: CBCL internalizing factor ~ Nucleus Accumbens activity (anticipation stage - All reward v. neutral)
### Females.
```{r Confirmatory3AFemaleAccumbens, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_females

confirmatory3A_nacc_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_nacc_females$gam)


```
### Males.
```{r Confirmatory3AMaleAccumbens, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males

confirmatory3A_nacc_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_nacc_males$gam)

```

## Model A: CBCL internalizing factor ~ Caudate activity (anticipation stage - All reward v. neutral)
### Females.
```{r Confirmatory3AFemaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females

confirmatory3A_caud_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_females$gam)


```
### Males.
```{r Confirmatory3AMaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_males

confirmatory3A_caud_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                               interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_males$gam)


```

## Model A: CBCL internalizing factor ~ Putamen activity (anticipation stage - All reward v. neutral)
### Females.
```{r Confirmatory3AFemalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females

confirmatory3A_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                               interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_putamen_females$gam)


```
### Males.
```{r Confirmatory3AMalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males

confirmatory3A_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_putamen_males$gam)

```

## Model B: CBCL internalizing factor ~ Average striatal activity (feedback stage)
### Females.
```{r Confirmatory3BFemale, echo = FALSE}
dataformodel <- data_no_striatal_feed_outliers_females

confirmatory3B_females <- gamm4(cbcl_scr_syn_internal_r ~ striatum_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_females$gam)
```
### Males.
```{r Confirmatory3BMale, echo = FALSE}
dataformodel <- data_no_striatal_feed_outliers_males

confirmatory3B_males <- gamm4(cbcl_scr_syn_internal_r ~ striatum_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_males$gam)
```
## Model B: CBCL internalizing factor ~ Accumbens activity (feedback stage)
### Females.
```{r Confirmatory3BFemaleAccumbens, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

confirmatory3B_accumbens_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_accumbens_females$gam)

```
### Males.
```{r Confirmatory3BMaleAccumbens, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

confirmatory3B_accumbens_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_accumbens_males$gam)
```

## Model B: CBCL internalizing factor ~ Caudate activity (feedback stage)
### Females.
```{r Confirmatory3BFemaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

confirmatory3B_caudate_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_females$gam)

```
### Males.
```{r Confirmatory3BMaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

confirmatory3B_caudate_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_males$gam)
```

## Model B: CBCL internalizing factor ~ Putamen activity (feedback stage)
### Females.
```{r Confirmatory3BFemalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

confirmatory3B_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_putamen_females$gam)

```
### Males.
```{r Confirmatory3BMalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

confirmatory3B_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_putamen_males$gam)
```

## Model C: CBCL internalizing factor ~ Orbitofrontal cortex activity (anticipation stage)
### Females.
```{r Confirmatory3CFemale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_females
confirmatory3C_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_lOFC_females$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_females
confirmatory3C_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_females$gam)
```
### Males.
```{r Confirmatory3CMale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_males
confirmatory3C_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3C_lOFC_males$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_males
confirmatory3C_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_males$gam)
```

## Model D: CBCL internalizing factor ~ Orbitofrontal cortex activity (feedback stage)
### Females.
```{r Confirmatory3DFemale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_females

confirmatory3D_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3D_lOFC_females$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_females
confirmatory3D_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_females$gam)

```
### Males.
```{r Confirmatory3DMale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_males

confirmatory3D_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_lOFC_males$gam)


# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_males
confirmatory3D_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_males$gam)
```

# Exploratory Hypothesis 3A: We hypothesize that self-reported reward responsiveness (BAS - RR) will be negatively associated with internalizing symptoms.
## Model: CBCL internalizing factor ~ BIS-BAS-RR
### Females.
```{r Exploratory3AFemale, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory3A_females <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_females$gam)

```
### Males.
```{r Exploratory3AMale, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory3A_males <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_males$gam)

```

# Exploratory Hypothesis 3B: We hypothesize that behavioral reward responsiveness (i.e., MID Reaction Time reward vs. neutral trials) will be associated with internalizing symptoms, such that individuals with higher internalizing symptoms will have slower reaction times in response to reward.
# Model: CBCL internalizing factor ~ MID Reaction Time (reward vs. neutral trials)
### Females.
```{r Exploratory3BFemale, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_females_largereward_neutral$gam)

# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3B_females_largesmallreward$gam)

```
### Males.
```{r Exploratory3BMale, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largereward_neutral$gam)

# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largesmallreward$gam)
```

# RQ4
# Confirmatory Hypothesis 4: We predict that striatal responses to reward will moderate the effect of pubertal stage such that the relationship between advanced pubertal status and internalizing symptoms will be stronger among participants with attenuated activation in striatal reward circuitry during reward anticipation.
##  Model: CBCL internalizing factor ~ PDS*Striatal activity (anticipation stage)
### Females
```{r Confirmatory4Striatal_Females, echo = FALSE}
# Not excluding outliers in CBCL 
# Splitting by sex
# FEMALES

dataformodel <- data_no_striatal_ant_outliers_females

confirmatory4_compositestriatum_allCBCL_femalesonly <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            striatum_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(confirmatory4_compositestriatum_allCBCL_femalesonly$gam)
```

### Males
```{r Confirmatory4Striatal_Males, echo = FALSE}
# not  Excluding outliers in CBCL 
# Splitting by sex
# MALES

dataformodel <- data_no_striatal_ant_outliers_males

confirmatory4_compositestriatum_allCBCL_malesonly <- 
  gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            striatum_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                           #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_compositestriatum_allCBCL_malesonly$gam)
```

##Model: CBCL internalizing factor ~ PDS*accumbens activity (anticipation stage)
### Females
```{r Confirmatory4Accumbens_Females, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_accumbens_ant_outliers_females  #Specify data subset here

confirmatory4_accumbens_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_females$gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Confirmatory4Accumbens_Males, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_accumbens_ant_outliers_males  #Specify data subset here

confirmatory4_accumbens_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_males$gam)
# plot_model(confirmatory4_accumbens_ant_males,type = "int", show.data = TRUE) #Interaction plot
```

##Model: CBCL internalizing factor ~ PDS*caudate activity (anticipation stage)
### Females
```{r Confirmatory4Caudate_Females, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_caudate_ant_outliers_females  #Specify data subset here

confirmatory4_caudate_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_females$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Confirmatory4Caudate_Males, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_caudate_ant_outliers_males  #Specify data subset here

confirmatory4_caudate_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_males$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```


##Model: CBCL internalizing factor ~ PDS*putamen activity (anticipation stage)
### Females
```{r Confirmatory4Putamen_Females, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_putamen_ant_outliers_females  #Specify data subset here

confirmatory4_putamen_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_females$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Confirmatory4Putamen_males, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_putamen_ant_outliers_males

confirmatory4_putamen_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_males$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```



# Exploratory Hypothesis 4A: We will investigate whether striatal responses to reward during reward feedback moderates the effect of pubertal stage on internalizing symptoms. 
## Model: CBCL internalizing factor ~ PDS*Striatal activity (feedback stage) Females
### Females
```{r Exploratory4AStriatal_Females, echo = FALSE}
#Composite striatum score, FEMALES

dataformodel <- data_no_striatal_feed_outliers_females

exploratory4a_compositestriatum_feedback_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            striatum_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_compositestriatum_feedback_allCBCL_females$gam )
```
### Males
```{r Exploratory4AStriatal_Males, echo = FALSE}
#Composite striatum score, MALES

dataformodel <- data_no_striatal_feed_outliers_males

exploratory4a_compositestriatum_feedback_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            striatum_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_compositestriatum_feedback_allCBCL_males$gam )
```


##  Model: CBCL internalizing factor ~ PDS*accumbens activity 
###Females
```{r Exploratory4AAccumbens_Females, echo = FALSE}
# Accumbens feedback, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_accumbens_feed_outliers_females

exploratory4a_accumbens_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_females$gam )
```
###Males
```{r Exploratory4AAccumbens_Males, echo = FALSE}
#Accumbens feedback, males

dataformodel <- data_no_accumbens_feed_outliers_males

exploratory4a_accumbens_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_males$gam )
```

##  Model: CBCL internalizing factor ~ PDS*caudate activity 
###Females
```{r Exploratory4ACaudate_Females, echo = FALSE}
# Caudate feedback, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_caudate_feed_outliers_females

exploratory4a_caudate_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_females$gam )
```

###Males
```{r Exploratory4ACaudate_Males, echo = FALSE}
#Caudate feedback", maleS

dataformodel <- data_no_caudate_feed_outliers_males

exploratory4a_caudate_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_males$gam )
```

##  Model: CBCL internalizing factor ~ PDS*putamen activity 
###Females
```{r Exploratory4APutamen_Females, echo = FALSE}
# Putamen feedback, exlcuding outliers.
# No CBCL exclusions
# With covariates
dataformodel <- data_no_putamen_feed_outliers_females

exploratory4a_putamen_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_females$gam )
```

###Males
```{r Exploratory4APutamen_Females, echo = FALSE}
#Putamen feedback", maleS

dataformodel <- data_no_putamen_feed_outliers_males

exploratory4a_putamen_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_males$gam )
```


# Exploratory Hypothesis 4B: We will investigate whether OFC activation during reward anticipation and feedback moderates the relationship between pubertal stage and internalizing symptoms.
## Model A: CBCL internalizing factor ~ PDS*OFC activity (anticipation stage)
### Females
```{r Exploratory4BOFC_ant_females, echo = FALSE}
#Lateral OFC anticipation, FEMALES

dataformodel <- data_no_lOFC_ant_outliers_females

exploratory4b_OFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_females$gam )


#Medial OFC anticipation, FEMALES

dataformodel <- data_no_mOFC_ant_outliers_females

exploratory4b_mOFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_females$gam )
```

### Males
```{r Exploratory4BOFC_ant_males, echo = FALSE}
#Lateral OFC anticipation, MALES

dataformodel <- data_no_lOFC_ant_outliers_males

exploratory4b_OFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_males$gam )

#Medial OFC anticipation, MALES

dataformodel <- data_no_mOFC_ant_outliers_males

exploratory4b_mOFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_males$gam )
```

## Model B: CBCL internalizing factor ~ PDS*OFC activity (feedback stage)
### Females
```{r Exploratory4BOFC_feed_females, echo = FALSE}
#Lateral OFC feedback, FEMALES

dataformodel <- data_no_lOFC_feed_outliers_females

exploratory4b_OFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_females$gam )


#Medial OFC Feedback, FEMALES
dataformodel <- data_no_mOFC_feed_outliers_females

exploratory4b_mOFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_females$gam )
```

### Males
```{r Exploratory4BOFC_feed_males, echo = FALSE}
#Lateral OFC feedback, MALES

dataformodel <- data_no_lOFC_feed_outliers_males

exploratory4b_OFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_males$gam )

#Medial OFC feedback, MALES

dataformodel <- data_no_mOFC_feed_outliers_males

exploratory4b_mOFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_males$gam )
```

# Exploratory Hypothesis 4C: We hypothesize that the association between advanced puberty and internalizing symptoms will be moderated by self-reported reward responsiveness. We predict that advanced puberty will be associated with higher internalizing in individuals who report lower reward responsiveness on the BIS-BAS questionnaire.

## Model: CBCL internalizing factor ~ PDS*BIS-BAS
### Females
```{r Exploratory4C, echo = FALSE}
#FEMALES
dataformodel <- data_no_bisbas_outliers_females

exploratory4c_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_females$gam )
```

### Males
```{r Exploratory4C, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory4c_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_males$gam)

# Plot (for sample 1).
# Start by using z scored bis bas.
exploratory4c_bisbas_allCBCL_males_bisbasz <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_males_bisbasz$gam)

plot_model(exploratory4c_bisbas_allCBCL_males_bisbasz,
                type = "pred", # To specify values bisbas, have to use "pred" instead.
                terms = c("PDS_score","bisbas_ss_basm_rr_z[-2.0,0,2.0]"),colors = "Pastel1") +
                ylab("Model predicted internalizing score") +
                xlab("PDS Score") +
                labs(colour = "BAS-RR Z-score") +
                nsh_theme
```

# Exploratory Hypothesis 4D: We hypothesize that the association between advanced puberty and internalizing symptoms will be moderated by behavioral reward responsiveness (i.e., MID reaction time). We predict that advanced puberty will be associated with higher internalizing in individuals who demonstrate lower behavioral reward responsiveness.
## Model: CBCL internalizing factor ~ PDS*MID reaction time
### Females
```{r Exploratory4D, echo = FALSE}
#FEMALES
dataformodel <- data_no_RT_MID_outliers_females

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratory4c_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_females$gam)
```

```{r Exploratory4D, echo = FALSE}
#LARGE REWARD VS. SMALL REWARD POSITIVE
exploratory4c_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_females$gam)
```
###Males
```{r}
dataformodel <- data_no_RT_MID_outliers_males

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratory4c_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_males$gam)
```

```{r}
#LARGE REWARD VS. SMALL REWARD POSITIVE
exploratory4c_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_males$gam)
```

# Exploratory Hypothesis 4E: We will investigate whether testosterone, and its relationship with reward, relates to internalizing symptoms, while controlling for PDS.
## Model A: CBCL internalizing factor ~ Testosterone*Striatal activity (anticipation stage) + PDS
### Females
```{r}
dataformodel <- data_no_striatal_ant_test_outliers_females

confirmatory4Ea_striatum_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            striatum_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_striatum_allCBCL_test_females$gam)
```

### Males
```{r}
dataformodel <- data_no_striatal_ant_test_outliers_males

exploratory4Ea_striatum_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            striatum_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Ea_striatum_allCBCL_test_males$gam)
```

## Model B: CBCL internalizing factor ~ Testosterone*Striatal activity (feedback stage) + PDS
### Females
```{r}
dataformodel <- data_no_striatal_feed_outliers_females

exploratory4Ea_striatum_feedback_allCBCL_test_females  <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            striatum_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Ea_striatum_feedback_allCBCL_test_females$gam )
```
### Males
```{r}
dataformodel <- data_no_striatal_feed_outliers_males

exploratory4Ea_striatum_feedback_allCBCL_test_males  <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            striatum_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Ea_striatum_feedback_allCBCL_test_males$gam )
```


##Model: CBCL internalizing factor ~ PDS*accumbens activity (anticipation stage) + testosterone
### Females
```{r Exploratory4e_Accumbens_Anticipation_Testosterones_Females, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_females  #Specify data subset here

confirmatory4Ea_accumbens_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```
### Males
```{r r Exploratory4e_Accumbens_Anticipation_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_males  #Specify data subset here

confirmatory4Ea_accumbens_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_males $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

##Model: CBCL internalizing factor ~ PDS*caudate activity (anticipation stage) + testosterone
### Females
```{r Exploratory4e_Caudate_Anticipation_Testosterones_Females, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_caudate_ant_no_test_outliers_females  #Specify data subset here

confirmatory4Ea_caudate_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r r Exploratory4e_Caudate_Anticipation_Testosterones_Males, echo = FALSE}
# Composite striatum score, exlcuding outliers.
# No CBCL exclusions
# With covariates

dataformodel <- data_no_caudate_ant_no_test_outliers_males  #Specify data subset here

confirmatory4Ea_caudate_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_males $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

##Model: CBCL internalizing factor ~ PDS*putamen activity (anticipation stage) + testosterone
### Females
```{r Exploratory4e_Putamen_Anticipation_Testosterones_Females, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_females  #Specify data subset here

confirmatory4Ea_putamen_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Exploratory4e_Putamen_Anticipation_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_males  #Specify data subset here

confirmatory4Ea_putamen_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_males $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```



# Exploratory Hypothesis 4EB: We will investigate whether testosterone, and its relationship with reward, relates to internalizing symptoms, while controlling for PDS.

##Model: CBCL internalizing factor ~ PDS*accumbens activity (feedback stage) + testosterone
### Females
```{r Exploratory4eb_Accumbens_Feedback_Testosterones_Females, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_females  #Specify data subset here

exploratory4Eb_accumbens_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_females$gam)

```
### Males
```{r Exploratory4eb_Accumbens_Feedback_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_males  #Specify data subset here

exploratory4Eb_accumbens_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_males$gam)
```

##Model: CBCL internalizing factor ~ PDS*caudate activity (Feedback stage) + testosterone
### Females
```{r Exploratory4eb_Caudate_Feedback_Testosterones_Females, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_females #Specify data subset here

confirmatory4Eb_caudate_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_females$gam)
```

### Males
```{r r Exploratory4eb_Caudate_Feedback_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_caudate_feed_no_test_outliers_males #Specify data subset here

confirmatory4Eb_caudate_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_males$gam)
```

##Model: CBCL internalizing factor ~ PDS*putamen activity (Feedback stage) + testosterone
### Females
```{r Exploratory4eb_Putamen_Feedback_Testosterones_Females, echo = FALSE}
dataformodel <- data_no_putamen_feed_no_test_outliers_females #Specify data subset here

confirmatory4Eb_putamen_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_females$gam)

```

### Males
```{r Exploratory4eb_Putamen_Feedback_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_putamen_feed_outliers_no_test_males #Specify data subset here

confirmatory4Eb_putamen_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_males$gam)
```

## Model C: CBCL internalizing factor ~ Testosterone*OFC activity (anticipation stage) + PDS
### Females
```{r}
#Lateral OFC - FEMALES

dataformodel <- data_no_lOFC_ant_test_outliers_females 

exploratory4c_OFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_females$gam )


#Medial OFC - FEMALES
dataformodel <- data_no_mOFC_ant_test_outliers_females 

exploratory4c_mOFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_females$gam )
```
### Males
```{r}
#Lateral OFC - MALES
dataformodel <- data_no_lOFC_ant_test_outliers_males 

exploratory4c_OFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_males$gam )


#Medial OFC - MALES
dataformodel <- data_no_mOFC_ant_test_outliers_males 

exploratory4c_mOFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_males$gam )
```

## Model D: CBCL internalizing factor ~ Testosterone*OFC activity (feedback stage) + PDS
### Females
```{r Exploratory4DOFC_feed_females, echo = FALSE}
#Lateral OFC feedback, FEMALES

dataformodel <- data_no_lOFC_feed_test_outliers_females 

exploratory4d_OFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_females$gam )


#Medial OFC feedback, FEMALES

dataformodel <- data_no_mOFC_feed_test_outliers_females 

exploratory4d_mOFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_females$gam )
```


### Males
```{r Exploratory4DOFC_feed_males, echo = FALSE}
#Lateral OFC feedback, MALES

dataformodel <- data_no_lOFC_feed_test_outliers_males 

exploratory4d_OFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_males$gam )


#Medial OFC feedback, MALES

dataformodel <- data_no_mOFC_feed_test_outliers_males 

exploratory4d_mOFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_males$gam )

```




## Model E: CBCL internalizing factor ~ Testosterone*BIS-BAS RR
### Females
```{r Exploratory4e, echo = FALSE}
#FEMALES
dataformodel <- data_no_bisbas_test_outliers_females 

exploratory4e_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_females$gam )
```



## Model E: CBCL internalizing factor ~ Testosterone*BIS-BAS RR
### Males
```{r Exploratory4e, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_males 

exploratory4e_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_males$gam )
```


## Model F: CBCL internalizing factor ~ Testosterone*MID Reaction Time
##Females 
```{r ExploratoryFa, echo = FALSE}
#FEMALES
dataformodel <- data_no_RT_test_outliers_females

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratoryFa_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_females$gam)
```

```{r ExploratoryFb, echo = FALSE}
#LARGE REWARD VS. SMALL REWARD POSITIVE

dataformodel <- data_no_RT_test_outliers_females

exploratoryFb_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_small_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_females$gam)
```




##Males 
```{r ExploratoryFa, echo = FALSE}
dataformodel <- data_no_RT_test_outliers_males

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratoryFa_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_males$gam)
```



```{r ExploratoryFb, echo = FALSE}
#LARGE REWARD VS. SMALL REWARD POSITIVE

dataformodel <- data_no_RT_test_outliers_males

exploratoryFb_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            #sex+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_males$gam)
```

