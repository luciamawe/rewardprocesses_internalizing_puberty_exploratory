---
title: "Supplement A"
author: "Elizabeth McNeilly"
date: "10/29/2021"
output: html_document
---
#NOTE:  This script provides the results for Sample 1.

# SETUP
```{r loadPackages, echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(gamm4)
library(dplyr)
library(insight)
library(here)
library(lmerTest)
library(gamm4.test)
library(mgcv)
library(jtools)
library(interactions)
library(ggstatsplot)
library(clubSandwich) # For robust standard errors.


# Elizabeth.
# Data: Desktop⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# Code: Desktop⁩ ▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code⁩

# Lucia.
# Data:  Github⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# Code:  Github ▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code

# Natalie.
# Data:  Desktop ▸ ABCD⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# Code:  Desktop ▸ ABCD ⁩▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code

# LMW alternative to read in the data.

data_dir = ((dirname(here()))) 

phase_folder = "exploratory"  # select the appropriate folder.
#phase_folder = "confirmatory"  # select the appropriate folder.

data_folder <- file.path(data_dir,"ABCD","derivatives",phase_folder)

file_name <- "nda30_exploratory.csv" # specify file name here. 

fulldata <- read.csv(file.path(data_folder,file_name))
nrow(fulldata) # 27321 (exploratory). When call the define_dataframes script, will keep only the baseline data.

# Call function to define all of the dataframes.
script_path <- file.path(data_dir,"rewardprocesses_internalizing_puberty_exploratory","code","define_dataframes.R")
source(script_path)
```

# 1---Int~Puberty---

## 1.1 Model: CBCL internalizing factor ~ PDS
### Females
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_internal_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```

## 1.2 Model: CBCL Anxious-Depressed ~ PDS
### Females
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)

coef_test(confirmatory2_females$mer, vcov = "CR2", coeffs = "all")
# beta =  0.42161; t= 2.56; p = 0.019.
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_anxdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```
## 1.3 Model: CBCL Withdrawn-Depressed ~ PDS
### Females
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)
coef_test(confirmatory2_females$mer, vcov = "CR2", coeffs = "all")
# beta = 0.38; t= 4.53; p < 0.001.
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_syn_withdep_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```
## 1.4 Model: CBCL Depressed DSM-5 ~ PDS
### Females
```{r Confirmatory2, echo = FALSE}
# Including CBCL outliers.
dataformodel <- PDS_correct_females

# Females.
confirmatory2_females <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))

summary(confirmatory2_females$gam)

coef_test(confirmatory2_females$mer, vcov = "CR2", coeffs = "all")
# beta = 0.32; t= 3.32; p = 0.004.
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males

confirmatory2_males <- gamm4(cbcl_scr_dsm5_depress_r ~ PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
          
summary(confirmatory2_males$gam)

```



## 1.5 Model: CBCL internalizing factor ~ Pubertal category
### Females
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_internal_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## 1.6 Model: CBCL Anxious-Depressed ~ Pubertal category
### Females 
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_anxdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## 1.7 Model: CBCL Withdrawn-Depressed ~ Pubertal category
### Females
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_syn_withdep_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```

## 1.8 Model: CBCL Depressed DSM-5 ~ Pubertal category
### Females
```{r Confirmatory2_category, echo = FALSE}
# Females.
dataformodel <- PDS_correct_females
confirmatory2_category_females <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_females$gam) 
```
### Males
```{r}
# Males.
dataformodel <- PDS_correct_males
confirmatory2_category_males <- gamm4(cbcl_scr_dsm5_depress_r ~ pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic, 
                      data = dataformodel, 
                      random = ~ (1 | site_id_l/rel_family_id))
summary(confirmatory2_category_males$gam)
```



## 1.9 Model: CBCL internalizing factor ~ Testosterone
### Females
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```
## 1.10 Model: CBCL Anxious-Depressed ~ Testosterone
### Females
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```

## 1.11 Model: CBCL Withdrawn-Depressed ~ Testosterone
### Females
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```

### Males
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```
## 1.12 Model: CBCL Depressed DSM-5 ~ Testosterone
### Females
```{r}
dataformodel <- data_no_test_outliers_females

confirmatory2_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_female$gam)
```
### Males
```{r}
dataformodel <- data_no_test_outliers_males

confirmatory2_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2_testosterone_CBCL_male$gam)
```


## 1.13 Model: CBCL internalizing factor ~ Testosterone + PDS 
### Females
```{r Exploratory2B, echo = FALSE}

dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r}
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```

## 1.14 Model: CBCL internalizing factor ~ Testosterone + Pubertal category 
### Females
```{r}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r}
# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_internal_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## 1.15 Model: CBCL Anxious-Depressed ~ Testosterone + PDS 
### Females
```{r Exploratory2B, echo = FALSE}
#FEMALES
dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r}
#MALES
dataformodel <- data_no_test_outliers_males 
  
confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```

## 1.16 Model: CBCL Anxious-Depressed ~ Testosterone + Pubertal Category
### Females
```{r}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r}
# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_anxdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## 1.17 Model: CBCL Withdrawn-Depressed ~ Testosterone + PDS
### Females
```{r Exploratory2B, echo = FALSE}
#FEMALES
dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r}
#MALES
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```
## 1.18 Model: CBCL Withdrawn-Depressed ~ Testosterone + Pubertal Category
### Females
```{r}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r}
# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_syn_withdep_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```
## 1.19 Model: CBCL Depressed DSM-5 ~ Testosterone + PDS 
### Females
```{r Exploratory2B, echo = FALSE}
#FEMALES
dataformodel <- data_no_test_outliers_females

confirmatory2B_testosterone_CBCL_female <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female$gam)
```
### Males
```{r}
#MALES
dataformodel <- data_no_test_outliers_males 
  

confirmatory2B_testosterone_CBCL_male <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + PDS_score +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male$gam)
```

## 1.20 Model: CBCL Depressed DSM-5 ~ Testosterone + Pubertal category 
### Females
```{r}
# PDS category.

dataformodel <- subset(PDS_correct_females, hormone_scr_ert_mean_z > -3 & hormone_scr_ert_mean_z < 3 & pds_p_ss_category !="5")

confirmatory2B_testosterone_CBCL_female_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,  
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_female_category$gam)
```
### Males
```{r}
# PDS category.
confirmatory2B_testosterone_CBCL_male_category <- gamm4(cbcl_scr_dsm5_depress_r ~ hormone_scr_ert_mean_z + pds_p_ss_category +
                      race.ethnicity.5level +
                      interview_age +
                      demo_race_hispanic,
                      data = dataformodel,
                      random = ~ (1 | site_id_l/rel_family_id))
                      
summary(confirmatory2B_testosterone_CBCL_male_category$gam)
```







# 2---Reward~Puberty---

## 2.1 Model: BIS-BAS-RR ~ PDS
### Females
```{r Exploratory1BFemales, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory1B_females <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_females$gam)

```
### Males
```{r Exploratory1BMales, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory1B_males <- gamm4(bisbas_ss_basm_rr_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1B_males$gam)

```


## 2.2 Model : Reaction Time ~ PDS

### Females
```{r Exploratory1CFemales, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_females

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_females$gam)


# Large reward vs. small positive.
exploratory1C_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_females$gam)
```

### Males
```{r Exploratory1CMales, echo = FALSE}
dataformodel <- data_no_RT_MID_outliers_males

# Large reward vs. neutral positive.
exploratory1C_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_neutral_RT_males$gam)


# Large reward vs. small positive.
exploratory1C_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1C_lg_small_RT_males$gam)
```



## 2.3 Model: Caudate Anticipation ~ PDS
### Females
```{r Confirmatory1Female_Caudate, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females 

confirmatory1_caudate_females <- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_females$gam)

```

### Males
```{r Confirmatory1Male, echo = FALSE}
dataformodel <- data_no_striatal_ant_outliers_males

confirmatory1_caudate_males<- gamm4(caudate_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_caudate_males$gam)

```

## 2.4 Model B: Putamen Anticipation ~ PDS
### Females
```{r Confirmatory1Female_Putamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females 

confirmatory1_putamen_females <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_females$gam)

```

### Males
```{r Confirmatory1Male_Putamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males 

confirmatory1_putamen_males <- gamm4(putamen_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_putamen_males$gam)
```

## 2.5 Model: Accumbens Anticipation ~ PDS
### Females
```{r Confirmatory1Female_Accumbens, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_females 

confirmatory1_accumbens_females <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_females$gam)

```

### Males
```{r Confirmatory1Male_Accumbens, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males 

confirmatory1_accumbens_males <- gamm4(accumbens_rvsn_ant_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(confirmatory1_accumbens_males$gam)

```


## 2.6 Model: Caudate Feedback  ~ PDS
### Females
```{r Exploratory1A_Caudate_Females, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

exploratory1A_caudate_females <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_females$gam)

```

### Males
```{r Exploratory1A_Caudate_Males, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

exploratory1A_caudate_males <- gamm4(caudate_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_caudate_males$gam)

```
## 2.7 Model: Putamen Feedback ~ PDS
### Females
```{r Exploratory1A_Putamen_Females, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

exploratory1A_putamen_females <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_females$gam)

```

### Males
```{r Exploratory1A_Putamen_males, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

exploratory1A_putamen_males <- gamm4(putamen_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_putamen_males$gam)

```
## 2.8 Model: Accumbens Feedback ~ PDS
### Females
```{r Exploratory1A_Accumbens_Females, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

exploratory1A_accumbens_females <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_females$gam)

```

### Males
```{r Exploratory1A_Accumbens_Males, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

exploratory1A_accumbens_males <- gamm4(accumbens_posvsneg_feedback_z ~ PDS_score + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(exploratory1A_accumbens_males$gam)

```


## 2.9 Model: OFC activation (anticipation stage) ~ Testosterone
### Females
```{r Exploratory1D_C, echo = FALSE}
## Model C: OFC activation (anticipation stage) ~ Testosterone

# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_females
modelC_females_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_females
modelC_females_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_females_mOFC$gam)

```

### Males
```{r}
# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_ant_test_outliers_males
modelC_males_lOFC <- gamm4(lOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_ant_test_outliers_males
modelC_males_mOFC <- gamm4(mOFC_rvsn_ant_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelC_males_mOFC$gam)
```

## 2.10 Model: OFC activation (feedback stage) ~ Testosterone
### Females
```{r Exploratory1D_D, echo = FALSE}
## Model D: OFC activation (feedback stage) ~ Testosterone

# Females (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_females
modelD_females_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_lOFC$gam)


# Females (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_females
modelD_females_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_females_mOFC$gam)
```

### Males
```{r}

# Males (lateral OFC; lOFC).
dataformodel <- data_no_lOFC_feed_test_outliers_males
modelD_males_lOFC <- gamm4(lOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_lOFC$gam)


# Males (medial OFC; mOFC).
dataformodel <- data_no_mOFC_feed_test_outliers_males
modelD_males_mOFC <- gamm4(mOFC_posvsneg_feedback_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelD_males_mOFC$gam)
```

## 2.11 Model: MID Reaction Time ~ Testosterone
### Females
```{r Exploratory1D, echo = FALSE}
## Model E: MID Reaction Time ~ Testosterone
# Females: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_neutral_RT_females <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_females$gam)

# Females: large reward vs. small reward.
dataformodel <- data_no_RT_test_outliers_females # No MID RT difference score or testosterone outliers.
modelE_lg_small_RT_females <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_females$gam)
```

### Males
```{r}
# Males: large reward vs. neutral.
dataformodel <- data_no_RT_test_outliers_males # No MID RT difference score or testosterone outliers.

modelE_lg_neutral_RT_males <- gamm4(rt_diff_large_neutral_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_neutral_RT_males$gam)

# Males: large reward vs. small reward.
modelE_lg_small_RT_males <- gamm4(rt_diff_large_small_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelE_lg_small_RT_males$gam)
```

## 2.12 Model: BIS-BAS-RR ~ Testosterone
### Females
```{r Exploratory1D_F, echo = FALSE}
## Model F: BIS-BAS-RR ~ Testosterone
#Females
dataformodel <- data_no_bisbas_test_outliers_females
modelF_females <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_females$gam)
```
### Males
```{r}
dataformodel <- data_no_bisbas_test_outliers_males
modelF_males <- gamm4(bisbas_ss_basm_rr_z ~ hormone_scr_ert_mean_z + interview_age,
                               random = ~ (1 | site_id_l/rel_family_id),
                               data = dataformodel)

summary(modelF_males$gam)
```









# 3---Int~Reward---

## 3.1 Model: CBCL internalizing factor ~ Nucleus Accumbens activity (anticipation stage - All reward v. neutral)
### Females
```{r Confirmatory3AFemaleAccumbens, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_females

confirmatory3A_nacc_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_nacc_females$gam)


```
### Males
```{r Confirmatory3AMaleAccumbens, echo = FALSE}
dataformodel <- data_no_accumbens_ant_outliers_males

confirmatory3A_nacc_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_nacc_males$gam)

```

## 3.2 Model: CBCL internalizing factor ~ Caudate activity (anticipation stage - All reward v. neutral)
### Females
```{r Confirmatory3AFemaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_females

confirmatory3A_caud_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_females$gam)


```
### Males
```{r Confirmatory3AMaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_ant_outliers_males

confirmatory3A_caud_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_rvsn_ant_z +
                               interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_caud_males$gam)


```

## 3.3 Model: CBCL internalizing factor ~ Putamen activity (anticipation stage - All reward v. neutral)
### Females
```{r Confirmatory3AFemalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_females

confirmatory3A_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                               interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3A_putamen_females$gam)


```
### Males
```{r Confirmatory3AMalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_ant_outliers_males

confirmatory3A_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3A_putamen_males$gam)

```


## 3.4 Model: CBCL internalizing factor ~ Accumbens activity (feedback stage)
### Females
```{r Confirmatory3BFemaleAccumbens, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_females

confirmatory3B_accumbens_females <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_accumbens_females$gam)

```
### Males
```{r Confirmatory3BMaleAccumbens, echo = FALSE}
dataformodel <- data_no_accumbens_feed_outliers_males

confirmatory3B_accumbens_males <- gamm4(cbcl_scr_syn_internal_r ~ accumbens_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_accumbens_males$gam)
```

## 3.5 Model: CBCL internalizing factor ~ Caudate activity (feedback stage)
### Females
```{r Confirmatory3BFemaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_females

confirmatory3B_caudate_females <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_females$gam)

```
### Males
```{r Confirmatory3BMaleCaudate, echo = FALSE}
dataformodel <- data_no_caudate_feed_outliers_males

confirmatory3B_caudate_males <- gamm4(cbcl_scr_syn_internal_r ~ caudate_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_caudate_males$gam)
```

## 3.6 Model: CBCL internalizing factor ~ Putamen activity (feedback stage)
### Females
```{r Confirmatory3BFemalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_females

confirmatory3B_putamen_females <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3B_putamen_females$gam)

```
### Males
```{r Confirmatory3BMalePutamen, echo = FALSE}
dataformodel <- data_no_putamen_feed_outliers_males

confirmatory3B_putamen_males <- gamm4(cbcl_scr_syn_internal_r ~ putamen_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3B_putamen_males$gam)
```

## 3.7 Model: CBCL internalizing factor ~ Orbitofrontal cortex activity (anticipation stage)
### Females
```{r Confirmatory3CFemale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_females
confirmatory3C_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_lOFC_females$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_females
confirmatory3C_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_females$gam)
```
### Males
```{r Confirmatory3CMale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_ant_outliers_males
confirmatory3C_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3C_lOFC_males$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_ant_outliers_males
confirmatory3C_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_rvsn_ant_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3C_mOFC_males$gam)
```

## 3.8 Model: CBCL internalizing factor ~ Orbitofrontal cortex activity (feedback stage)
### Females
```{r Confirmatory3DFemale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_females

confirmatory3D_lOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(confirmatory3D_lOFC_females$gam)

# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_females
confirmatory3D_mOFC_females <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_females$gam)

```
### Males
```{r Confirmatory3DMale, echo = FALSE}
# Lateral OFC.
dataformodel <- data_no_lOFC_feed_outliers_males

confirmatory3D_lOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ lOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_lOFC_males$gam)


# Medial OFC.
dataformodel <- data_no_mOFC_feed_outliers_males
confirmatory3D_mOFC_males <- gamm4(cbcl_scr_syn_internal_r ~ mOFC_posvsneg_feedback_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(confirmatory3D_mOFC_males$gam)
```

## 3.9 Model: CBCL internalizing factor ~ BIS-BAS-RR
### Females
```{r Exploratory3AFemale, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_females

exploratory3A_females <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_females$gam)

```
### Males
```{r Exploratory3AMale, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory3A_males <- gamm4(cbcl_scr_syn_internal_r ~ bisbas_ss_basm_rr +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3A_males$gam)

```


## 3.10 Model: CBCL internalizing factor ~ MID Reaction Time (reward vs. neutral trials)
### Females
```{r Exploratory3BFemale, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_females_largereward_neutral$gam)

# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_females

exploratory3B_females_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)
summary(exploratory3B_females_largesmallreward$gam)

```
### Males
```{r Exploratory3BMale, echo = FALSE}

# Large reward vs. neutral trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largereward_neutral <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_neutral_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largereward_neutral$gam)

# Large reward vs. small reward trial reaction time.
dataformodel <- data_no_RT_MID_outliers_males

exploratory3B_males_largesmallreward <- gamm4(cbcl_scr_syn_internal_r ~ rt_diff_large_small_z +
                              interview_age +
                              race.ethnicity.5level +
                              demo_race_hispanic, 
                              random = ~ (1 | site_id_l/rel_family_id),
                              data = dataformodel)

summary(exploratory3B_males_largesmallreward$gam)
```

# 4---Int~Puberty*Reward---

## 4.1 Model: CBCL internalizing factor ~ PDS*accumbens activity (anticipation stage)
### Females
```{r Confirmatory4Accumbens_Females, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_females  #Specify data subset here

confirmatory4_accumbens_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_females$gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Confirmatory4Accumbens_Males, echo = FALSE}

dataformodel <- data_no_accumbens_ant_outliers_males  #Specify data subset here

confirmatory4_accumbens_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_accumbens_ant_males$gam)
# plot_model(confirmatory4_accumbens_ant_males,type = "int", show.data = TRUE) #Interaction plot
```

## 4.2 Model: CBCL internalizing factor ~ PDS*caudate activity (anticipation stage)
### Females
```{r Confirmatory4Caudate_Females, echo = FALSE}

dataformodel <- data_no_caudate_ant_outliers_females  #Specify data subset here

confirmatory4_caudate_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_females$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Confirmatory4Caudate_Males, echo = FALSE}

dataformodel <- data_no_caudate_ant_outliers_males  #Specify data subset here

confirmatory4_caudate_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_caudate_ant_males$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```


## 4.3 Model: CBCL internalizing factor ~ PDS*putamen activity (anticipation stage)
### Females
```{r Confirmatory4Putamen_Females, echo = FALSE}

dataformodel <- data_no_putamen_ant_outliers_females  #Specify data subset here

confirmatory4_putamen_ant_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_females$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Confirmatory4Putamen_males, echo = FALSE}

dataformodel <- data_no_putamen_ant_outliers_males

confirmatory4_putamen_ant_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4_putamen_ant_males$gam)
#plot_model(confirmatory4_caudate_ant_females,type = "int", show.data = TRUE) #Interaction plot
```
## 4.4 Model: CBCL internalizing factor ~ PDS*lateral OFC activity (anticipation stage)
### Females
```{r Exploratory4BOFC_ant_females, echo = FALSE}
#Lateral OFC anticipation, FEMALES

dataformodel <- data_no_lOFC_ant_outliers_females

exploratory4b_OFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_females$gam )
```

### Males
```{r Exploratory4BOFC_ant_males, echo = FALSE}
#Lateral OFC anticipation, MALES

dataformodel <- data_no_lOFC_ant_outliers_males

exploratory4b_OFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_ant_allCBCL_males$gam )

```

## 4.5 Model: CBCL internalizing factor ~ PDS*medial OFC activity (anticipation stage)
### Females
```{r}
#Medial OFC anticipation, FEMALES

dataformodel <- data_no_mOFC_ant_outliers_females

exploratory4b_mOFC_ant_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_females$gam )
```

### Males
```{r}
#Medial OFC anticipation, MALES

dataformodel <- data_no_mOFC_ant_outliers_males

exploratory4b_mOFC_ant_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_ant_allCBCL_males$gam )
```



## 4.6 Model: CBCL internalizing factor ~ PDS*accumbens activity (feedback)
###Females
```{r Exploratory4AAccumbens_Females, echo = FALSE}
#Accumbens feedback, females
dataformodel <- data_no_accumbens_feed_outliers_females

exploratory4a_accumbens_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_females$gam )
```
###Males
```{r Exploratory4AAccumbens_Males, echo = FALSE}
#Accumbens feedback, males

dataformodel <- data_no_accumbens_feed_outliers_males

exploratory4a_accumbens_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_accumbens_feedback_males$gam )
```

## 4.7 Model: CBCL internalizing factor ~ PDS*caudate activity (feedback)
###Females
```{r Exploratory4ACaudate_Females, echo = FALSE}

dataformodel <- data_no_caudate_feed_outliers_females

exploratory4a_caudate_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_females$gam )
```

###Males
```{r Exploratory4ACaudate_Males, echo = FALSE}

dataformodel <- data_no_caudate_feed_outliers_males

exploratory4a_caudate_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_caudate_feedback_males$gam )
```

## 4.8 Model: CBCL internalizing factor ~ PDS*putamen activity (feedback)
### Females
```{r Exploratory4APutamen_Females, echo = FALSE}

dataformodel <- data_no_putamen_feed_outliers_females

exploratory4a_putamen_feedback_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_females$gam )
```

### Males
```{r Exploratory4APutamen_Females, echo = FALSE}
#Putamen feedback", males

dataformodel <- data_no_putamen_feed_outliers_males

exploratory4a_putamen_feedback_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4a_putamen_feedback_males$gam )
```




## 4.9 Model: CBCL internalizing factor ~ PDS*lateral OFC activity (feedback stage)
### Females
```{r Exploratory4BOFC_feed_females, echo = FALSE}
#Lateral OFC feedback, FEMALES

dataformodel <- data_no_lOFC_feed_outliers_females

exploratory4b_OFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_females$gam )
```

### Males
```{r Exploratory4BOFC_feed_males, echo = FALSE}
#Lateral OFC feedback, MALES

dataformodel <- data_no_lOFC_feed_outliers_males

exploratory4b_OFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_OFC_feed_allCBCL_males$gam )
```

## 4.10 Model: CBCL internalizing factor ~ PDS*medial OFC activity (feedback stage)
### Females
```{r}
#Medial OFC Feedback, FEMALES
dataformodel <- data_no_mOFC_feed_outliers_females

exploratory4b_mOFC_feed_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_females$gam )
```


### Males
```{r}
#Medial OFC feedback, MALES

dataformodel <- data_no_mOFC_feed_outliers_males

exploratory4b_mOFC_feed_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4b_mOFC_feed_allCBCL_males$gam )
```


## 4.11 Model: CBCL internalizing factor ~ PDS*BIS-BAS
### Females
```{r Exploratory4C, echo = FALSE}
#FEMALES
dataformodel <- data_no_bisbas_outliers_females

exploratory4c_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_females$gam )
```

### Males
```{r Exploratory4C, echo = FALSE}
dataformodel <- data_no_bisbas_outliers_males

exploratory4c_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4c_bisbas_allCBCL_males$gam)

```


## 4.12 Model: CBCL internalizing factor ~ PDS*MID reaction time (large reward vs. neutral)
### Females
```{r Exploratory4D, echo = FALSE}
#FEMALES
dataformodel <- data_no_RT_MID_outliers_females

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratory4c_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_females$gam)
```

### Males
```{r}
dataformodel <- data_no_RT_MID_outliers_males

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratory4c_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_neutral_RT_males$gam)
```


## 4.13 Model: CBCL internalizing factor ~ PDS*MID reaction time (large vs. small reward)
### Females
```{r Exploratory4D, echo = FALSE}
#LARGE REWARD VS. SMALL REWARD POSITIVE
exploratory4c_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_females$gam)
```

### Males
```{r}
#LARGE REWARD VS. SMALL REWARD POSITIVE
exploratory4c_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_lg_small_RT_males$gam)
```


## 4.14 Model: CBCL internalizing factor ~ testosterone*accumbens activity (anticipation stage) + PDS
### Females
```{r Exploratory4e_Accumbens_Anticipation_Testosterones_Females, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_females  #Specify data subset here

confirmatory4Ea_accumbens_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```
### Males
```{r r Exploratory4e_Accumbens_Anticipation_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_accumbens_ant_no_test_outliers_males  #Specify data subset here

confirmatory4Ea_accumbens_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_accumbens_test_males $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

## 4.15 Model: CBCL internalizing factor ~ testosterone*caudate activity (anticipation stage) + PDS
### Females
```{r Exploratory4e_Caudate_Anticipation_Testosterones_Females, echo = FALSE}

dataformodel <- data_no_caudate_ant_no_test_outliers_females  #Specify data subset here

confirmatory4Ea_caudate_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            #high.educ +
                            #household.income +
                            #married.or.livingtogether +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r r Exploratory4e_Caudate_Anticipation_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_caudate_ant_no_test_outliers_males  #Specify data subset here

confirmatory4Ea_caudate_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_caudate_test_males $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

## 4.16 Model: CBCL internalizing factor ~ testosterone*putamen activity (anticipation stage) + PDS
### Females
```{r Exploratory4e_Putamen_Anticipation_Testosterones_Females, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_females  #Specify data subset here

confirmatory4Ea_putamen_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_females $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```

### Males
```{r Exploratory4e_Putamen_Anticipation_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_putamen_ant_no_test_outliers_males  #Specify data subset here

confirmatory4Ea_putamen_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Ea_putamen_test_males $gam)
#plot_model(confirmatory4_accumbens_ant_females,type = "int", show.data = TRUE) #Interaction plot
```


## 4.17 Model: CBCL internalizing factor ~ testosterone*accumbens activity (feedback stage) + PDS
### Females
```{r Exploratory4eb_Accumbens_Feedback_Testosterones_Females, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_females  #Specify data subset here

exploratory4Eb_accumbens_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_females$gam)

```
### Males
```{r Exploratory4eb_Accumbens_Feedback_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_accumbens_feed_no_test_outliers_males  #Specify data subset here

exploratory4Eb_accumbens_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            accumbens_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4Eb_accumbens_test_feed_males$gam)
```

## 4.18 Model: CBCL internalizing factor ~ testosterone*caudate activity (Feedback stage) + PDS
### Females
```{r Exploratory4eb_Caudate_Feedback_Testosterones_Females, echo = FALSE}
dataformodel <- data_no_caudate_feed_no_test_outliers_females #Specify data subset here

confirmatory4Eb_caudate_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_females$gam)
```

### Males
```{r r Exploratory4eb_Caudate_Feedback_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_caudate_feed_no_test_outliers_males #Specify data subset here

confirmatory4Eb_caudate_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            caudate_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_caudate_test_feed_males$gam)
```

## 4.19 Model: CBCL internalizing factor ~ testosterone*putamen activity (Feedback stage) + PDS
### Females
```{r Exploratory4eb_Putamen_Feedback_Testosterones_Females, echo = FALSE}
dataformodel <- data_no_putamen_feed_no_test_outliers_females #Specify data subset here

confirmatory4Eb_putamen_test_feed_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_females$gam)

```

### Males
```{r Exploratory4eb_Putamen_Feedback_Testosterones_Males, echo = FALSE}

dataformodel <- data_no_putamen_feed_outliers_no_test_males #Specify data subset here

confirmatory4Eb_putamen_test_feed_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            putamen_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age,
                            data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(confirmatory4Eb_putamen_test_feed_males$gam)
```

## 4.20 Model: CBCL internalizing factor ~ Testosterone*lateral OFC activity (anticipation stage) + PDS
### Females
```{r}
#Lateral OFC - FEMALES

dataformodel <- data_no_lOFC_ant_test_outliers_females 

exploratory4c_OFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_females$gam )
```

### Males
```{r}
#Lateral OFC - MALES
dataformodel <- data_no_lOFC_ant_test_outliers_males 

exploratory4c_OFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            lOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_OFC_ant_allCBCL_test_males$gam )
```


## 4.21 Model: CBCL internalizing factor ~ Testosterone*medial OFC activity (anticipation stage) + PDS
### Females
```{r}
#Medial OFC - FEMALES
dataformodel <- data_no_mOFC_ant_test_outliers_females 

exploratory4c_mOFC_ant_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_females$gam )
```

### Males
```{r}
#Medial OFC - MALES
dataformodel <- data_no_mOFC_ant_test_outliers_males 

exploratory4c_mOFC_ant_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                           PDS_score+
                            hormone_scr_ert_mean*  
                            mOFC_rvsn_ant_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4c_mOFC_ant_allCBCL_test_males$gam )
```

## 4.22 Model: CBCL internalizing factor ~ Testosterone*lateral OFC activity (feedback stage) + PDS
### Females
```{r Exploratory4DOFC_feed_females, echo = FALSE}
#Lateral OFC feedback, FEMALES

dataformodel <- data_no_lOFC_feed_test_outliers_females 

exploratory4d_OFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_females$gam )
```

### Males
```{r Exploratory4DOFC_feed_males, echo = FALSE}
#Lateral OFC feedback, MALES

dataformodel <- data_no_lOFC_feed_test_outliers_males 

exploratory4d_OFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            lOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_OFC_feed_allCBCL_test_males$gam )
```

## 4.23 Model: CBCL internalizing factor ~ Testosterone*medial OFC activity (feedback stage) + PDS
### Females
```{r}
#Medial OFC feedback, FEMALES

dataformodel <- data_no_mOFC_feed_test_outliers_females 

exploratory4d_mOFC_feed_allCBCL_test_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_females$gam )
```

### Males
```{r}
#Medial OFC feedback, MALES

dataformodel <- data_no_mOFC_feed_test_outliers_males 

exploratory4d_mOFC_feed_allCBCL_test_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean* 
                            mOFC_posvsneg_feedback_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratory4d_mOFC_feed_allCBCL_test_males$gam )

```


## 4.24 Model: CBCL internalizing factor ~ Testosterone*BIS-BAS RR + PDS
### Females
```{r Exploratory4e, echo = FALSE}
#FEMALES
dataformodel <- data_no_bisbas_test_outliers_females 

exploratory4e_bisbas_allCBCL_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_females$gam )
```

### Males
```{r Exploratory4e, echo = FALSE}

dataformodel <- data_no_bisbas_test_outliers_males 

exploratory4e_bisbas_allCBCL_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            bisbas_ss_basm_rr+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                           interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())
summary(exploratory4e_bisbas_allCBCL_males$gam )
```


## 4.25 Model: CBCL internalizing factor ~ Testosterone*MID Reaction Time + PDS (large reward vs. neutral) 
### Females 
```{r ExploratoryFa, echo = FALSE}
#FEMALES
dataformodel <- data_no_RT_test_outliers_females

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratoryFa_lg_neutral_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_females$gam)
```
### Males 
```{r ExploratoryFa, echo = FALSE}
dataformodel <- data_no_RT_test_outliers_males

#LARGE REWARD VS. NEUTRAL POSITIVE
exploratoryFa_lg_neutral_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_neutral_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFa_lg_neutral_RT_males$gam)
```



## 4.26 Model: CBCL internalizing factor ~ Testosterone*MID Reaction Time + PDS (large vs. small reward)
### Females 
```{r ExploratoryFb, echo = FALSE}
#LARGE REWARD VS. SMALL REWARD POSITIVE

dataformodel <- data_no_RT_test_outliers_females

exploratoryFb_lg_small_RT_females <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_females$gam)
```

### Males
```{r ExploratoryFb, echo = FALSE}
#LARGE REWARD VS. SMALL REWARD POSITIVE

dataformodel <- data_no_RT_test_outliers_males

exploratoryFb_lg_small_RT_males <- gamm4(cbcl_scr_syn_internal_r ~ 
                            PDS_score+
                            hormone_scr_ert_mean*
                            rt_diff_large_small_z+
                            race.ethnicity.5level +
                            demo_race_hispanic +
                            interview_age, data=dataformodel, random = ~ (1 | site_id_l/rel_family_id),family=gaussian())

summary(exploratoryFb_lg_small_RT_males$gam)
```

