---
title: "Research Question 1: Research Question 1: Does pubertal development relate to neural and behavioral responses to reward?"
date: "August 2020"
output:
  html_document: default
  pdf_document: default
authors: Natalie Saragosa-Harris 
---
``` {r loadPackages, echo = FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(gamm4)
library(dplyr)
library(sjPlot)
library(here)
```

```{r LoadData, echo = FALSE}
# Change this to your directory and the name of your data file.
datapath <- "/Users/nataliesaragosa-harris/Desktop/ABCD/output"
datafile <- "nda20_exploratory.csv"
setwd(datapath)

# Elizabeth.
# My data live here: Desktop⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# My code live here: Desktop⁩ ▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code⁩

# Lucia.
# My data live here:  Github⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# My code live here:  Github ▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code

# Natalie.
# My data live here:  Desktop ▸ ABCD⁩ ▸ ⁨ABCD⁩ ▸ ⁨derivatives⁩ ▸ ⁨exploratory⁩
# My code live here:  Desktop ▸ ABCD ⁩▸ ⁨rewardprocesses_internalizing_puberty_exploratory⁩ ▸ ⁨code

# LMW alternative to read in the data.
data_dir = ((dirname(here()))) 

phase_folder = "exploratory"  #select the appropiate folder
#phase_folder = "confirmatory"  #select the appropiate folder

data_folder <- file.path(data_dir,"ABCD","derivatives",phase_folder)

file_name <- "nda20_exploratory.csv" #specify file name here 

fulldata <- read.csv(file.path(data_folder,file_name))
length(fulldata$src_subject_id) # 5934.

# Call function to define all of the dataframes.
⁩



```

```{r settheme, echo = FALSE}
nsh_theme <- theme(title= element_text(size=26, vjust=2, face="bold"),
         plot.title = element_blank(),
         axis.title.x= element_text(size=18, vjust=-0.3),
         axis.title.y= element_text(size=18, vjust=1.5),
         axis.text.x= element_text(size=18, colour="black"),
         axis.text.y= element_text(size=18, colour="black"),
         strip.text = element_text(size=24, face="bold"),
         panel.background = element_blank(),
         axis.line = element_line(colour = "black"))

```

# Confirmatory Hypothesis 1: We hypothesize that pubertal stage will be associated with neural response to reward during a monetary incentive delay task (Braams et al., 2015). In particular, we expect heightened striatal activation during reward anticipation for more advanced pubertal stages.
## Model: Striatal activation (anticipation stage) ~ Pubertal stage
```{r Confirmatory1, echo = FALSE}
confirmatory1_females <- lmer(striatum_rvsn_ant_z ~ PDS_score +
                      race.ethnicity.5level +
                      high.educ +
                      household.income +
                      married.or.livingtogether +
                      interview_age +
                      demo_race_hispanic, +
                      (1 | site_id_l/rel_family_id),
                      data = data_no_striatal_ant_outliers_females)
summary(confirmatory1_females) # Singularity problem?
plot_model(confirmatory1_females,type = "pred", terms = "PDS_score", show.data = FALSE)

plot_model(confirmatory1_females,type = "est", show.data = FALSE) # forest plot.


```
# Exploratory Hypothesis 1A: We will explore whether striatal activation during reward feedback is related to pubertal stage.
## Model: Striatal activation (feedback stage) ~ Pubertal stage 
```{r Exploratory1A, echo = FALSE}

```
# Exploratory Hypothesis 1B: We hypothesize that more advanced pubertal stages will be associated with greater self-reported reward responsiveness (BAS - RR) (Harden et al. 2018).
## Model: BIS-BAS-RR ~ Pubertal stage
```{r Exploratory1B, echo = FALSE}

```
# Exploratory Hypothesis 1C: We hypothesize that greater pubertal stage will be associated with greater behavioral reactivity to reward (i.e., reaction time on reward vs. neutral trials).
## Model: Reaction Time ~ Pubertal Stage
```{r Exploratory1C, echo = FALSE}

```
# Exploratory Hypothesis 1D: We hypothesize that testosterone will be positively associated with our indicators of reward (neural activity, behavioral reaction time, and self-reported reward responsiveness).
## Model A: Striatal activation (anticipation stage) ~ Testosterone
## Model B: Striatal activation (feedback stage) ~ Testosterone
## Model C: OFC activation (anticipation stage) ~ Testosterone
## Model D: OFC activation (feedback stage) ~ Testosterone
## Model E: MID Reaction Time ~ Testosterone
## Model F: BIS-BAS-RR ~ Testosterone
```{r Exploratory1D, echo = FALSE}

```